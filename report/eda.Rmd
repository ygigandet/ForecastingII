## EDA

```{r, echo = FALSE, message = FALSE, warning=FALSE}
source(here::here("scripts/setup.R"))
```

```{r}
# Creation of time series
Bietschhorn <- as_tsibble(Bietschhorn)
Blancherie <- as_tsibble(Blancherie)
Cible <- as_tsibble(Cible)
GSD <- as_tsibble(GSD)
PRP <- as_tsibble(PRP)
Platta <- as_tsibble(Platta)
Planta <- as_tsibble(Planta)
CRR <- as_tsibble(CRR)
Campus <- as_tsibble(Campus)
Scex <- as_tsibble(Scex)
Furet <- as_tsibble(Furet)
Agasse <- as_tsibble(Agasse)
Stade <- as_tsibble(Stade)
GSN <- as_tsibble(GSN)
Stand <- as_tsibble(Stand)
Bramois <- as_tsibble(Bramois)
```

### **Data Description**

#### **Blancherie **
```{r echo=FALSE, message=FALSE}
Blancherie <- as_tsibble(Blancherie)
weekday <- weekdays(Blancherie$date)
Blancherie$weekday <- weekday # Get the weekday values
Blancherie$time <- as.POSIXct(Blancherie$date, format = "%H:%M:%S %p")
Blancherie$time <- as.numeric(Blancherie$date) #convert date values to numeric
as.numeric(Blancherie$time)

blancherie <- Blancherie %>% 
  mutate(minutes = time - lag(time, default = first(time))) # subtract days
blancherie$minutes <- as.numeric(as.character(blancherie$minutes))/60 # transform to minutes
blancherie$minutes[blancherie$minutes == 0] <- blancherie$minutes[2] 
blancherie_ts <- blancherie %>%
  relocate(date, .before = Bike) %>%
    select(-time,-name)

blancherie_monday <- blancherie_ts %>% 
  filter(weekday == "lunes")
unique(blancherie_monday[c("minutes")]) # Identify the unique values of a column

############### Monday
#  convert our data frame from wide to long format.
blancherie <- blancherie_ts %>% 
  gather("Bike", "E-Bike", "Capacity", key = Types, value = Number) %>%
  relocate(Types, .before = weekday) %>%
  relocate(Number, .before = weekday)

# Plot Multiple Series On Same Axes for Monday
blancherie %>% filter(weekday == "lunes") %>%
  filter(minutes == 60) %>%
  select(-weekday, -minutes) %>%
  autoplot(Number) +
  xlab("Date[60m]") + ylab("Amount of Bikes") +
  ggtitle("Frequencies of usage on Monday")

############### Tuesday
blancherie_tuesday <- blancherie_ts %>% 
  filter(weekday == "martes")
unique(blancherie_tuesday[c("minutes")]) # Identify the unique values of a column

# Plot Multiple Series On Same Axes for Tuesday
blancherie %>% filter(weekday == "martes") %>%
  filter(minutes == 60) %>%
  select(-weekday, -minutes) %>%
  autoplot(Number) +
  xlab("Date[60m]") + ylab("Amount of Bikes") +
  ggtitle("Frequencies of usage on Monday")

```
